# -*- coding: utf-8 -*-
indice = [
    '399001',   #深证成指    399001  1994-07-20  1000    40
    '399002',   #成份A指     399002  1994-07-20  1000    40
    '399004',   #深证100R    399004  2002-12-31  1000    100
    '399005',   #中小板指    399005  2005-06-07  1000    100
    '399006',   #创业板指    399006  2010-05-31  1000    100
    '399007',   #深证300     399007  2004-12-31  1000    300
    '399008',   #中小300     399008  2010-03-19  1000    300
    '399009',   #深证200     399009  2004-12-31  1000    200
    '399010',   #深证700     399010  2004-12-31  1000    700
    '399011',   #深证1000    399011  2004-12-31  1000    1000
    '399012',   #创业300     399012  2012-06-29  1000    300
    '399303',   #国证小盘    399303  2009-12-31  3326.4448   --
    '399310',   #巨潮50      399310  2002-12-31  1000    50
    '399311',   #巨潮1000    399311  2002-12-31  1000    1000
    '399312',   #巨潮300     399312  2002-12-31  1000    300
    '399313',   #巨潮100     399313  2002-12-31  1000    100
    '399314',   #巨潮大盘    399314  2002-12-31  1000    200
    '399315',   #巨潮中盘    399315  2002-12-31  1000    300
    '399316',   #巨潮小盘    399316  2002-12-31  1000    500
    '399317',   #巨潮A指     399317  2002-12-31  1000    500
    '399330',   #深证100     399330  2002-12-31  1000    100
    '399333',   #中小板R     399333  2005-06-07  1000    100
    '399344',   #深证300R    399344  2004-12-31  1000    300
    '399351',   #深报指数    399351  2004-08-31  864.38  40
    '399352',   #深报综指    399352  2004-08-31  864.38  --
    '399355',   #长三角指数  399355  2002-12-31  1000    40
    '399356',   #珠三角指数  399356  2002-12-31  1000    40
    '399357',   #环渤海指数  399357  2002-12-31  1000    40
    '399400',   #大中盘      399400  2002-12-31  1000    500
    '399401',   #中小盘      399401  2002-12-31  1000    800
    '399606',   #创业板R     399606  2010-05-31  1000    100
    '399612',   #中创100     399612  2007-06-29  1000    100
	'399623',   #中小基础    399623  2005-12-30  1000    --
	'399624',   #中创400     399624  2010-06-30  1000    400
	'399625',   #中创500     399625  2010-06-30  1000    500
	'399640',   #创业基础    399640  2010-12-31  1000    --
	'000009',   #上证380     000009  2003-12-31  1000.0  380
	'000010',   #上证180     000010  2002-06-28  3299.06     180
	'000016',   #上证50      000016  2003-12-31  1000.0  50
	'000043',   #超大盘      000043  2003-12-31  1000.0  20
	'000044',   #上证中盘    000044  2003-12-31  1000.0  130
	'000045',   #上证小盘    000045  2003-12-31  1000.0  320
	'000046',   #上证中小    000046  2003-12-31  1000.0  450
	'000047',   #上证全指    000047  2003-12-31  1000.0  500
    '000155',   #市值百强    000155  2003-12-31  1000.0  100
	'000300',   #沪深300     000300  2004-12-31  1000.0  300
	'000852',   #中证1000    000852  2004-12-31  1000.0  1000
	'000902',   #中证流通    000902  2005-12-30  1000.0  --
	'000903',   #中证100     000903  2005-12-30  1000.0  100
	'000904',   #中证200     000904  2004-12-31  1000.0  200
    '000905',   #中证500     000905  2004-12-31  1000.0  500
	'000906',   #中证800     000906  2004-12-31  1000.0  800
	'000907',   #中证700     000907  2004-12-31  1000.0  700
	'000980',   #中证超大    000980  2004-12-31  1000.0  50
	'000985',   #中证全指    000985  2004-12-31  1000.0  --
    'CN6001',   #安徽指数    CN6001  2002-12-31  1000    --
    'CN6002',   #北京指数    CN6002  2002-12-31  1000    --
    'CN6003',   #福建指数    CN6003  2002-12-31  1000    --
    'CN6004',   #甘肃指数    CN6004  2002-12-31  1000    --
    'CN6005',   #广东指数    CN6005  2002-12-31  1000    --
    'CN6006',   #广西指数    CN6006  2002-12-31  1000    --
    'CN6007',   #贵州指数    CN6007  2002-12-31  1000    --
    'CN6008',   #海南指数    CN6008  2002-12-31  1000    --
    'CN6009',   #河北指数    CN6009  2002-12-31  1000    --
    'CN6010',   #河南指数    CN6010  2002-12-31  1000    --
    'CN6011',   #黑龙江指    CN6011  2002-12-31  1000    --
    'CN6012',   #湖北指数    CN6012  2002-12-31  1000    --
    'CN6013',   #湖南指数    CN6013  2002-12-31  1000    --
    'CN6014',   #吉林指数    CN6014  2002-12-31  1000    --
    'CN6015',   #江苏指数    CN6015  2002-12-31  1000    --
    'CN6016',   #江西指数    CN6016  2002-12-31  1000    --
    'CN6017',   #辽宁指数    CN6017  2002-12-31  1000    --
    'CN6018',   #内蒙古指    CN6018  2002-12-31  1000    --
    'CN6019',   #宁夏指数    CN6019  2002-12-31  1000    --
    'CN6020',   #青海指数    CN6020  2002-12-31  1000    --
    'CN6021',   #山东指数    CN6021  2002-12-31  1000    --
    'CN6022',   #山西指数    CN6022  2002-12-31  1000    --
    'CN6023',   #陕西指数    CN6023  2002-12-31  1000    --
    'CN6024',   #上海指数    CN6024  2002-12-31  1000    --
    'CN6025',   #四川指数    CN6025  2002-12-31  1000    --
    'CN6026',   #天津指数    CN6026  2002-12-31  1000    --
    'CN6027',   #西藏指数    CN6027  2002-12-31  1000    --
    'CN6028',   #新疆指数    CN6028  2002-12-31  1000    --
    'CN6029',   #云南指数    CN6029  2002-12-31  1000    --
    'CN6030',   #浙江指数    CN6030  2002-12-31  1000    --
    'CN6031',   #重庆指数    CN6031  2002-12-31  1000    --
    ]

CMD1 = """
SELECT
  sm1.SecuCode, sm1.SecuMarket, sm2.SecuCode
FROM
  LC_IndexComponent ic JOIN SecuMain sm1 ON ic.IndexInnerCode = sm1.InnerCode
  JOIN SecuMain sm2 ON ic.SecuInnerCode = sm2.InnerCode
WHERE
  ic.InDate <= CONVERT(DATE, '{date}')
  AND
  (ic.OutDate IS NULL OR ic.OutDate > CONVERT(DATE, '{date}'))
  AND
  sm1.SecuMarket IN (83, 90)
  AND
  sm1.SecuCategory = 4
  AND
  sm2.SecuCategory = 1
  AND
  sm2.SecuMarket IN (83, 90)
  AND
  LEFT(sm2.SecuCode, 2) IN ('60', '00', '30')
"""

CMD2 = """
SELECT
  sm1.SecuCode, sm1.SecuMarket, sm2.SecuCode, cw.Weight
FROM
  SecuMain sm1 JOIN LC_IndexComponentsWeight cw ON sm1.InnerCode = cw.IndexCode
  JOIN SecuMain sm2 ON sm2.InnerCode = cw.InnerCode
WHERE
  cw.EndDate = (SELECT MAX(EndDate)
                FROM LC_IndexComponentsWeight
                WHERE IndexCode = cw.IndexCode AND EndDate <= CONVERT(DATE, '{date}'))
  AND
  sm1.SecuMarket IN (83, 90)
  AND
  sm1.SecuCategory = 4
  AND
  sm2.SecuCategory = 1
  AND
  sm2.SecuMarket IN (83, 90)
  AND
  LEFT(sm2.SecuCode, 2) IN ('60', '00', '30')
"""
